<!doctype html>

<html lang="en">

<head>
  <meta charset="utf-8">

  <title>The HTML5 Herald</title>
  <meta name="description" content="The HTML5 Herald">
  <meta name="author" content="SitePoint">

  <link rel="stylesheet" href="css/style.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.0/jquery.min.js"></script>
  <script src="https://cdn.jwplayer.com/libraries/qRAcfc2W.js" type="text/javascript"></script>
</head>

<body>
  <h1 id="h">This is jw player example</h1>
  <br><br>
  <div id="mediaplayer"></div>
  <div class="options-container hidden">
    <a href="#" class="btn1" data-video-name="" data-video-id=""><object id="object1"  data="" type="image/svg+xml" ></object></a>
    <a href="#" class="btn2" data-video-name="" data-video-id=""><object id="object2" data="" type="image/svg+xml"></object></a>
    <a href="#" class="btn3" data-video-name="" data-video-id=""><object id="object3"  data="" type="image/svg+xml"></object></a>
  </div>


  <script type="text/javascript">
    /*
    =====================================
    --- EDITABLE PART ---
    edit this object videos id or add 
    as many  new videos you want. You must
    have to keep your video extension within
    "id" property.
    =====================================
    */
    var videoIDs = {
      "video_1": {
        "id": "7vR8CjU6.mp4",
        "name": "video_1",
        "video_A": {
          "id": "vhFckVXt.mp4",
          "name": "video_A",
          "valid": false,
          "button": {
            "id": "bnt2",
            "src": "btn-icons/1-2A.svg"
          }
        },
        "video_B": {
          "id": "9460YL96.mp4",
          "name": "video_B",
          "valid": false,
          "button": {
            "id": "bnt3",
            "src": "btn-icons/1-2B.svg"
          }
        },
        "video_C": {
          "id": "2fNizj8p.mp4",
          "name": "video_C",
          "valid": true,
          "button": {
            "id": "bnt1",
            "src": "btn-icons/1-2C.svg"
          }
        },
        "loopVideo": "Zm4PxpaQ.mp4"
      },
      "video_2": {
        "id": "7vR8CjU6.mp4",
        "name": "video_1",
        "video_A": {
          "id": "vhFckVXt.mp4",
          "name": "video_A",
          "valid": false,
          "button": {
            "id": "bnt3",
            "src": "btn-icons/2-2A.svg"
          }
        },
        "video_B": {
          "id": "9460YL96.mp4",
          "name": "video_B",
          "valid": false,
          "button": {
            "id": "bnt1",
            "src": "btn-icons/2-2B.svg"
          }
        },
        "video_C": {
          "id": "2fNizj8p.mp4",
          "name": "video_C",
          "valid": true,
          "button": {
            "id": "bnt2",
            "src": "btn-icons/2-2C.svg"
          }
        },
        "loopVideo": "Zm4PxpaQ.mp4"
      },
      "video_3": {
        "id": "7vR8CjU6.mp4",
        "name": "video_1",
        "video_A": {
          "id": "vhFckVXt.mp4",
          "name": "video_A",
          "valid": false,
          "button": {
            "id": "bnt1",
            "src": "btn-icons/3-2A.svg"
          }
        },
        "video_B": {
          "id": "9460YL96.mp4",
          "name": "video_B",
          "valid": false,
          "button": {
            "id": "bnt2",
            "src": "btn-icons/3-2B.svg"
          }
        },
        "video_C": {
          "id": "2fNizj8p.mp4",
          "name": "video_C",
          "valid": true,
          "button": {
            "id": "bnt3",
            "src": "btn-icons/3-2C.svg"
          }
        },
        "loopVideo": "Zm4PxpaQ.mp4"
      },
      "finalLoop": ""
    };

    /*
    ============================================
    ---  NON EDITABLE PART ---
    logic for playing videos :
    ============================================
    */

    (function () {

      var playerInstance;
      var btnContainer = document.getElementsByClassName('options-container')[0];
      var btn1 = document.getElementsByClassName('btn1')[0];
      var btn2 = document.getElementsByClassName('btn2')[0];
      var btn3 = document.getElementsByClassName('btn3')[0];
      var obj1 = document.getElementById('object1');
      var obj2 = document.getElementById('object2');
      var obj3 = document.getElementById('object3');
      var tmpVideosArray = Object.getOwnPropertyNames(videoIDs);
      var tmpVideosArrayIndex = 0;
      var isLoopVideoAcive = true;
      var apiRoute = "http://content.jwplatform.com/videos/";

      /*
      ================================
      SETUP PLAYER
      ================================
      */

      var setupPlayer = function (thisFeed) {
        // Initialize the player
        playerInstance = jwplayer('mediaplayer').setup({
          file: "http://content.jwplatform.com/videos/" + videoIDs.video_1.id + ".mp4",
          'wmode': 'transparent',
          width: '780',
          height: '520',
          autostart: false,
          volume: 20,
          image: 'logo.png'
        });

      };

      setupPlayer();

      /*
     ================================
      PLAYER ON COMPLETE EVENT 
     ================================
     */

      playerInstance.on('complete', function () {
        var playerContainer = playerInstance.getContainer();
        playerContainer.appendChild(btnContainer, playerInstance);
        if (isLoopVideoAcive) {
          playerInstance.load({
            file: apiRoute + videoIDs[tmpVideosArray[tmpVideosArrayIndex]].loopVideo,
            repeat: true
          }).play();
          btnContainer.classList.remove("hidden");

          // btn2.setAttribute('data-video-id', videoIDs[tmpVideosArray[tmpVideosArrayIndex]].video_B.id);
          // btn2.setAttribute('data-video-name', videoIDs[tmpVideosArray[tmpVideosArrayIndex]].video_B.name);
          // btn3.setAttribute('data-video-id', videoIDs[tmpVideosArray[tmpVideosArrayIndex]].video_C.id);
          // btn3.setAttribute('data-video-name', videoIDs[tmpVideosArray[tmpVideosArrayIndex]].video_C.name);
          btnText();

        } else {
          btnContainer.classList.add("hidden");
          playerInstance.load({
            file: apiRoute + videoIDs[tmpVideosArray[tmpVideosArrayIndex]].id,
            repeat: true
          }).play();
          isLoopVideoAcive = true;
        }

      });
      btn1.onclick = btnEventCallback;
      btn2.onclick = btnEventCallback;
      btn3.onclick = btnEventCallback;

       /*
     ================================
     EVENT CALLBACK FOR BUTTONS 
     ================================
     */
      function btnEventCallback(e) {
        var el = e.target;
        var id = el.getAttribute('data-video-id');
        var name = el.getAttribute('data-video-name');
        if (videoIDs[tmpVideosArray[tmpVideosArrayIndex]][name].valid) {
          console.log('this option is good!!');
          console.log(name);
          tmpVideosArrayIndex++;
          isLoopVideoAcive = false;
          console.log('this is good option');
        } else {
          console.log('this option is not good!!');
          console.log(name);
          isLoopVideoAcive = true;
        }
        playerInstance.load({
          file: apiRoute + id
        }).play();
        btnContainer.classList.toggle("hidden");
        if (tmpVideosArrayIndex == tmpVideosArray.length) {
          isLoopVideoAcive = true;
          tmpVideosArrayIndex--;
        }
      }

     /*
     ================================
      ADD SVG TO BUTTON
     ================================
     */
      function btnText() {
        var optionTxtArray = [videoIDs[tmpVideosArray[tmpVideosArrayIndex]].video_A,
          videoIDs[tmpVideosArray[tmpVideosArrayIndex]].video_B,
          videoIDs[tmpVideosArray[tmpVideosArrayIndex]].video_C
        ];
        optionTxtArray.forEach(function (videoOption) {
          if (videoOption.button.id === 'bnt1') {
            obj1.setAttribute('data', videoOption.button.src);
            btn1.setAttribute('data-video-id', videoOption.id);
            btn1.setAttribute('data-video-name', videoOption.name);
          } else if (videoOption.button.id === 'bnt2') {
            obj2.setAttribute('data', videoOption.button.src);
            btn2.setAttribute('data-video-id', videoOption.id);
            btn2.setAttribute('data-video-name', videoOption.name);
          } else {
            obj3.setAttribute('data', videoOption.button.src);
            btn3.setAttribute('data-video-id', videoOption.id);
            btn3.setAttribute('data-video-name', videoOption.name);
          }

        });
      }
      //disable pause video
      // playerInstance.on('click',function () {
      //   playerInstance.play();
      // });



    })();
  </script>
</body>

</html>