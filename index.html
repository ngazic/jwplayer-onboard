<!doctype html>

<html lang="en">

<head>
  <meta charset="utf-8">

  <title>The HTML5 Herald</title>
  <meta name="description" content="The HTML5 Herald">
  <meta name="author" content="SitePoint">

  <link rel="stylesheet" href="css/style.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.0/jquery.min.js"></script>
  <script src="https://cdn.jwplayer.com/libraries/qRAcfc2W.js" type="text/javascript"></script>
</head>

<body>
  <h1 id="h">This is jw player example</h1>
  <br><br>
  <div id="mediaplayer"></div>
  <div class="options-container hidden">
    <a href="#" class="btn1" data-video-name="" data-video-id="">Button 1</a>
    <a href="#" class="btn2" data-video-name="" data-video-id="">Button 2</a>
    <a href="#" class="btn3" data-video-name="" data-video-id="">Button 3</a>
  </div>


  <script type="text/javascript">
    /*
    =====================================
    --- EDITABLE PART ---
    edit this object videos id or add 
    as many  new videos you want. You must
    have to keep your video extension within
    "id" property.
    =====================================
    */
    var videoIDs = {
      "video_1": {
        "id": "7vR8CjU6.mp4",
        "name": "video_1",
        "video_A": {
          "id": "vhFckVXt.mp4",
          "name": "video_A",
          "valid": false
        },
        "video_B": {
          "id": "9460YL96.mp4",
          "name": "video_B",
          "valid": false
        },
        "video_C": {
          "id": "2fNizj8p.mp4",
          "name": "video_C",
          "valid": true
        },
        "loopVideo": {
          "id": "Zm4PxpaQ.mp4",
          "name": "loopVideo"
        }
      }
    };

    /*
    ============================================
    ---  NON EDITABLE PART ---
    logic for playing videos :
    ============================================
    */

    (function () {

      var playerInstance;
      var btnContainer = document.getElementsByClassName('options-container')[0];
      var btn1 = document.getElementsByClassName('btn1')[0];
      var btn2 = document.getElementsByClassName('btn2')[0];
      var btn3 = document.getElementsByClassName('btn3')[0];
      var hiddenID = document.getElementById('tmpID');
      var tmpVideosArray = Object.getOwnPropertyNames(videoIDs);
      var tmpVideosArrayIndex = 0;
      var isLoopVideoAcive =true;
      var apiRoute = "http://content.jwplatform.com/videos/";
      var setupPlayer = function (thisFeed) {
        // Initialize the player
        playerInstance = jwplayer('mediaplayer').setup({
          file: "http://content.jwplatform.com/videos/" + videoIDs.video_1.id + ".mp4",
          'wmode': 'transparent',
          width: '780',
          height: '520',
          autostart: false,
          volume: 20,
          image: 'logo.png'
        });

      };

      setupPlayer();
      console.log(playerInstance.getPlaylist());
      playerInstance.on('complete', function () {
        var playerContainer = playerInstance.getContainer();
        playerContainer.appendChild(btnContainer, playerInstance);
        var btn1 = document.getElementsByClassName('btn1')[0];
        var btn2 = document.getElementsByClassName('btn2')[0];
        var btn3 = document.getElementsByClassName('btn3')[0];
        console.log(videoIDs[tmpVideosArray[tmpVideosArrayIndex]].video_A.name)
  
        if(isLoopVideoAcive){
          playerInstance.load({
            file: apiRoute + videoIDs[tmpVideosArray[tmpVideosArrayIndex]].loopVideo.id,
            repeat: true
          }).play();
        btnContainer.classList.remove("hidden");
        btn1.setAttribute('data-video-id', videoIDs[tmpVideosArray[tmpVideosArrayIndex]].video_A.id);
        btn1.setAttribute('data-video-name', videoIDs[tmpVideosArray[tmpVideosArrayIndex]].video_A.name);
        btn2.setAttribute('data-video-id', videoIDs[tmpVideosArray[tmpVideosArrayIndex]].video_B.id);
        btn2.setAttribute('data-video-name', videoIDs[tmpVideosArray[tmpVideosArrayIndex]].video_B.name);
        btn3.setAttribute('data-video-id', videoIDs[tmpVideosArray[tmpVideosArrayIndex]].video_C.id);
        btn3.setAttribute('data-video-name', videoIDs[tmpVideosArray[tmpVideosArrayIndex]].video_C.name);

        } else {
        btnContainer.classList.add("hidden");
        }

      });
      btn1.onclick = btnEventCallback;
      btn2.onclick = btnEventCallback;
      btn3.onclick = btnEventCallback;

      function btnEventCallback(e) {
        var el = e.target;
        var id = el.getAttribute('data-video-id');
        var name = el.getAttribute('data-video-name');
        if (videoIDs[tmpVideosArray[tmpVideosArrayIndex]][name].valid) {
         console.log('this option is good!!');
         tmpVideosArrayIndex ++;
         isLoopVideoAcive = false;
        } else {
          console.log('this option is not good!!');
          isLoopVideoAcive =true;
        }
        playerInstance.load({
          file: apiRoute + id
        }).play();
        btnContainer.classList.toggle("hidden");
        if(tmpVideosArrayIndex == tmpVideosArray.length)
        alert("this is the last video in playlist for now ")
      }
    })();
  </script>
</body>

</html>